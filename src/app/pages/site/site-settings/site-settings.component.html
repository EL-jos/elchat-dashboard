<div class="el-settings-container">

    <h2>Installation du widget ELChat</h2>
    <p>Pour permettre aux visiteurs de discuter avec l’IA, ajoutez ce snippet dans le <strong>head</strong> de votre
        site :</p>

    <mat-card>
        <mat-card-content class="snippet-card">
            <pre [innerHTML]="widgetSnippet" class="code-snippet"></pre>

            <button class="el-copy" mat-icon-button matTooltip="Copier le snippet" (click)="copySnippet()">
                <fa-icon [icon]="icons.copy"></fa-icon>
            </button>

            <span *ngIf="copied" class="copied-feedback">✔ Copié !</span>
        </mat-card-content>
    </mat-card>


    <p>Après avoir ajouté le snippet, vous pouvez tester la connexion :</p>

    <button mat-raised-button color="primary" (click)="testWidget()" [disabled]="testing">
        {{ testing ? 'Test en cours...' : 'Tester le widget' }}
    </button>

    <div *ngIf="testResult" class="test-result">
        <fa-icon *ngIf="testResult==='connected'" [icon]="icons.success" class="success"></fa-icon>
        <fa-icon *ngIf="testResult==='disconnected'" [icon]="icons.error" class="error"></fa-icon>
        <fa-icon *ngIf="testResult==='error'" [icon]="icons.error" class="error"></fa-icon>

        <span *ngIf="testResult==='connected'">✅ Widget connecté et opérationnel</span>
        <span *ngIf="testResult==='disconnected'">❌ Widget non détecté sur ce site</span>
        <span *ngIf="testResult==='error'">❌ Erreur lors du test du widget</span>
    </div>

</div>